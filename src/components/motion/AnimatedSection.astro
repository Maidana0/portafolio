---
// This component uses the `motion` library to animate its children
// when they become visible in the viewport. The `client:visible` directive
// on this component in the parent page ensures this script runs only
// when the element is visible.
---
<div class="motion-container">
  <slot />
</div>

<script>
  import { animate } from "motion";

  // `document.currentScript` refers to the <script> tag itself.
  // Its `previousElementSibling` is the <div> we want to animate.
  const elementToAnimate = document.currentScript.previousElementSibling;

  if (elementToAnimate) {
    // The element is now in the viewport, so we animate it directly.
    animate(
      elementToAnimate,
      { opacity: [0, 1], y: [20, 0] },
      { duration: 0.8, easing: "ease-out" }
    );
  }
</script>